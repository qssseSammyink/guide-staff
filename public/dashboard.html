<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Staff Dashboard</title>
<style>
/* ===== CSS Moderno e Dark ===== */
* { box-sizing: border-box; font-family: 'Inter', sans-serif; margin: 0; padding: 0; }
body { background: #07121b; color: #dfeff2; min-height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; padding: 24px; }
.dash { width: 100%; max-width: 980px; background: #0b171e; padding: 24px; border-radius: 12px; margin-top: 24px; box-shadow: 0 16px 32px rgba(0,0,0,0.7); border: 1px solid rgba(255,255,255,0.03); }
.dash-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
.dash-header h1 { font-size: 1.8rem; color: #7fffd4; }
button { padding: 10px 14px; border-radius: 8px; border: none; cursor: pointer; background: #1e6f5a; color: #fff; font-weight: 600; transition: all 0.2s ease; }
button:hover { background: #159b73; transform: translateY(-2px); box-shadow: 0 6px 16px rgba(21,155,115,0.4); }
#user-info { display: flex; align-items: center; gap: 16px; margin-bottom: 20px; }
#user-info img { border-radius: 50%; width: 80px; height: 80px; border: 2px solid #7fffd4; }
.controls { display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 16px; }
#logs-panel { background: rgba(255,255,255,0.03); padding: 16px; border-radius: 10px; box-shadow: 0 8px 20px rgba(0,0,0,0.5); max-height: 200px; overflow-y: auto; }
#logs-panel ul { list-style: none; padding: 0; }
#logs-panel li { padding: 6px 10px; margin-bottom: 6px; background: rgba(255,255,255,0.05); border-radius: 6px; font-size: 14px; }
</style>
</head>
<body>

<div class="dash">

  <div class="dash-header">
    <h1>Staff Dashboard</h1>
    <button id="btnLogout">Logout</button>
  </div>

  <!-- Informações do usuário -->
  <div id="user-info">
    <img id="user-avatar" src="" alt="Avatar">
    <div>
      <p id="user-tag"></p>
      <p id="user-id"></p>
      <p id="user-roles"></p>
    </div>
  </div>

  <!-- Ações Staff -->
  <div class="controls">
    <button id="btnKick">Expulsar usuário (simulado)</button>
    <button id="btnBan">Banir usuário (simulado)</button>
    <button id="btnMute">Silenciar usuário (simulado)</button>
    <button id="btnWarn">Avisar usuário (simulado)</button>
    <button id="btnReport">Gerar relatório (simulado)</button>
  </div>

  <!-- Logs -->
  <div id="logs-panel">
    <h2>Logs recentes</h2>
    <ul id="logs"></ul>
  </div>

</div>

<script>
// ===== JS Embutido =====
async function fetchJson(url, opts = {}) {
  const res = await fetch(url, opts);
  return res.json();
}

function addLog(text) {
  const logs = document.getElementById('logs');
  const li = document.createElement('li');
  li.textContent = text;
  logs.prepend(li);
}

async function initDashboard() {
  // Busca sessão
  const s = await fetchJson('/api/session');
  if (!s.ok) return window.location.href = '/';

  const user = s.user;
  document.getElementById('user-avatar').src = user.avatarURL || '';
  document.getElementById('user-tag').textContent = `${user.username}#${user.discriminator}`;
  document.getElementById('user-id').textContent = `ID: ${user.id}`;
  document.getElementById('user-roles').textContent = user.roles.join(', ');

  // Verifica Staff
  const staffCheck = await fetchJson('/api/isStaff');
  if (!staffCheck.ok) {
    alert('Você não tem acesso Staff');
    window.location.href = '/';
    return;
  }

  // Ações simuladas
  document.getElementById('btnKick').onclick = () => addLog('Usuário expulso (simulado)');
  document.getElementById('btnBan').onclick = () => addLog('Usuário banido (simulado)');
  document.getElementById('btnMute').onclick = () => addLog('Usuário silenciado (simulado)');
  document.getElementById('btnWarn').onclick = () => addLog('Usuário avisado (simulado)');
  document.getElementById('btnReport').onclick = () => addLog('Relatório gerado (simulado)');
  document.getElementById('btnLogout').onclick = async () => {
    await fetchJson('/api/logout');
    window.location.href = '/';
  };

  addLog('Dashboard carregado com sucesso!');
}

initDashboard();
</script>

</body>
</html>
